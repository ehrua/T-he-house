<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>탈출 – 2층</title>
<style>
  body {
    background:#111;
    color:#eee;
    font-family: "Noto Sans KR", sans-serif;
    padding: 20px;
  }
  #game {
    max-width: 700px;
    margin: auto;
  }
  button {
    display: block;
    margin: 8px 0;
    padding: 10px;
    width: 100%;
    background:#222;
    color:#eee;
    border:1px solid #444;
    cursor:pointer;
  }
  button:hover {
    background:#333;
  }
  .back {
    background:#111;
    border:1px dashed #555;
    margin-top: 20px;
  }
</style>
</head>
<body>
<div id="game">
  <p id="text"></p>
  <div id="choices"></div>
</div>

<script>
const textEl = document.getElementById("text");
const choicesEl = document.getElementById("choices");

const state = {
  location: "room",
  hasPinset: false,
  hasBasementKey: false,
  bookshelfOpened: false
};

function clearChoices() {
  choicesEl.innerHTML = "";
}

function addChoice(label, action, isBack=false) {
  const btn = document.createElement("button");
  btn.textContent = label;
  if (isBack) btn.classList.add("back");
  btn.onclick = action;
  choicesEl.appendChild(btn);
}

function showRoom() {
  state.location = "room";
  textEl.textContent =
    "어두운 방이다. 침대, 옷장, 서랍, 그리고 문이 보인다.";
  clearChoices();

  addChoice("침대 밑을 살핀다", () => {
    textEl.textContent = "아무것도 없다. 먼지만 가득하다.";
    clearChoices();
    addChoice("방으로 돌아간다", showRoom, true);
  });

  addChoice("서랍을 뒤진다", () => {
    if (!state.hasPinset) {
      state.hasPinset = true;
      textEl.textContent = "서랍 안에서 핀셋을 발견했다.";
    } else {
      textEl.textContent = "서랍 안에는 아무것도 없다.";
    }
    clearChoices();
    addChoice("방으로 돌아간다", showRoom, true);
  });

  addChoice("옷장을 연다", () => {
    textEl.textContent = "옷장 안은 비어 있다. 하지만 뒤로 갈 수는 없다.";
    clearChoices();
    addChoice("문으로 간다", tryDoor);
  });

  addChoice("문으로 간다", tryDoor);
}

function tryDoor() {
  clearChoices();
  if (state.hasPinset) {
    textEl.textContent =
      "핀셋으로 문을 열었다. 복도 너머로 서재가 보인다.";
    addChoice("서재로 들어간다", showStudy);
  } else {
    textEl.textContent =
      "문은 잠겨 있다. 무언가 얇은 도구가 필요할 것 같다.";
    addChoice("방으로 돌아간다", showRoom, true);
  }
}

function showStudy() {
  state.location = "study";
  textEl.textContent =
    "서재인 듯하다. 사진과 해부학 서적들이 가득 쌓여 있다.";
  clearChoices();

  addChoice("책들을 뒤진다", () => {
    if (!state.bookshelfOpened) {
      state.bookshelfOpened = true;
      textEl.textContent =
`책 하나를 잡아당기자 숨겨진 공간이 열렸다.

'이 글을 읽고 있다면 당신도 잡혀 왔겠죠.
2층: 방, 서재
1층: 주방, 거실, 화장실, 지하실로 향하는 문, 현관

탈출구는 두 곳.
현관: 비밀번호와 열쇠 필요
지하실: 도끼 열쇠 필요

납치범은 두 번의 기회를 준다.
첫 번째는 식칼, 두 번째는 도끼.
도끼를 들기 전에 찾아라.'

글은 그렇게 끝나 있었다.`;
    } else {
      textEl.textContent = "이미 살펴본 책들이다.";
    }
    clearChoices();
    addChoice("서재로 돌아간다", showStudy, true);
  });

  addChoice("서랍을 뒤진다", () => {
    if (!state.hasBasementKey) {
      state.hasBasementKey = true;
      textEl.textContent =
        "서랍에서 열쇠 하나를 발견했다. (지하실 열쇠)";
    } else {
      textEl.textContent = "서랍 안은 비어 있다.";
    }
    clearChoices();
    addChoice("서재로 돌아간다", showStudy, true);
  });

  addChoice("밖으로 나간다", () => {
    textEl.textContent =
      "문 앞에 누군가 서 있다. 눈이 마주친 순간, 의식이 끊겼다...";
    clearChoices();
    addChoice("지하실로 끌려간다", () => {
      textEl.textContent = "※ 2층 파트 종료 (지하실 파트로 이동)";
      clearChoices();
    });
  });

  addChoice("계단으로 간다", showStairs);
}

function showStairs() {
  textEl.textContent =
    "계단 앞이다. 아래로 내려가면 1층으로 이어질 것 같다.";
  clearChoices();
  addChoice("1층으로 내려간다", () => {
    textEl.textContent = "※ 2층 파트 종료 (1층 시작 지점)";
    clearChoices();
  });
}

// 시작
showRoom();
</script>
</body>
</html>
