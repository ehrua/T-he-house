<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>탈출</title>
<style>
    body {
        background: #000;
        color: #eee;
        font-family: "Noto Sans KR", sans-serif;
        padding: 40px;
        line-height: 1.8;
    }
    #game {
        max-width: 800px;
        margin: auto;
    }
    .choice {
        display: block;
        margin: 10px 0;
        padding: 12px;
        background: #111;
        border: 1px solid #444;
        color: #eee;
        cursor: pointer;
        text-align: left;
    }
    .choice:hover {
        background: #222;
    }
    .dead {
        color: #ff4d4d;
        font-weight: bold;
    }
</style>
</head>
<body>

<div id="game"></div>

<script>
let timeout = null;
let chance = 2;

function clearTimer() {
    if (timeout) {
        clearTimeout(timeout);
        timeout = null;
    }
}

function startDeathTimer() {
    clearTimer();
    timeout = setTimeout(() => {
        showText("문이 열린다.<br>\"깨어 있었네?\"", true);
        showChoices([
            { text: "사망", action: death }
        ]);
    }, 5000);
}

function showText(text, danger = false) {
    const game = document.getElementById("game");
    game.innerHTML = `<p ${danger ? 'class="dead"' : ""}>${text}</p>`;
}

function showChoices(choices, timed = false) {
    const game = document.getElementById("game");
    choices.forEach(c => {
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.innerText = c.text;
        btn.onclick = () => {
            clearTimer();
            c.action();
        };
        game.appendChild(btn);
    });
    if (timed) startDeathTimer();
}

function death() {
    showText("의식이 끊긴다.<br><br>사망했다.", true);
}

function startGame() {
    showText(
        "여느 날과 같은 새벽이다.<br>" +
        "대인 기피증 때문에 사람이 없는 새벽에 강아지 산책을 나왔다.<br>" +
        "퍽 소리와 함께 기억을 잃었다.<br><br>" +
        "눈을 떠보니 어느 집이다.<br>" +
        "창문은 모두 신문지와 나무 판자로 막혀 있다."
    );
    showChoices([
        { text: "나간다", action: lockedDoor },
        { text: "방을 살핀다", action: searchRoom },
        { text: "대기한다", action: wait }
    ]);
}

function lockedDoor() {
    showText("문이 열리지 않는다. 잠겨 있는 듯하다.<br>열쇠를 찾아야겠다.");
    showChoices([
        { text: "침대 밑", action: corpse },
        { text: "서랍", action: tweezers },
        { text: "옷장", action: closet }
    ]);
}

function corpse() {
    showText("사람 같은 것이 있다.<br>시체인 듯하다.");
    backToRoom();
}

function tweezers() {
    showText("서랍에서 핀셋을 발견했다.<br>이거라면 열 수 있지 않을까?");
    backToRoom();
}

function closet() {
    showText("옷장 안에는 아무것도 없다.<br>숨기에는 좋아 보인다.");
    backToRoom();
}

function backToRoom() {
    showChoices([
        { text: "방을 살핀다", action: searchRoom },
        { text: "대기한다", action: wait }
    ]);
}

function searchRoom() {
    showText(
        "바닥에서 문서를 발견했다.<br><br>" +
        "이름: 판태현<br>" +
        "나이: 30<br>" +
        "장기 상태: 간 양호 / 신장 양호 / 각막 양호…<br><br>" +
        "아마 장기 매매를 하려는 것 같다."
    );
    showChoices([
        { text: "침대 밑", action: corpse },
        { text: "서랍", action: tweezers },
        { text: "옷장", action: closet }
    ]);
}

function wait() {
    showText("시간이 흐른다…<br>발소리가 들린다.", true);
    showChoices([
        { text: "가만히 있는다", action: death }
    ], true);
}

// 게임 시작
startGame();
</script>

</body>
</html>
