<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>탈출</title>
<style>
body {
  background:#000;
  color:#eee;
  font-family: 'Malgun Gothic';
}
#game {
  max-width: 760px;
  margin: 40px auto;
  line-height: 1.7;
}
button {
  display:block;
  margin:8px 0;
  padding:8px 12px;
  background:#111;
  color:#eee;
  border:1px solid #444;
  cursor:pointer;
}
button:hover { background:#222; }
</style>
</head>
<body>

<div id="game"></div>

<script>
const game = document.getElementById("game");

const state = {
  tweezers:false,
  basementKey:false,
  lobbyKey:false,
  safeKey:false,
  passwordKnown:false,
  caught:false
};

function render(text, choices=[]) {
  game.innerHTML = `<p>${text.replace(/\n/g,"<br>")}</p>`;
  choices.forEach(c=>{
    const b=document.createElement("button");
    b.textContent=c.text;
    b.onclick=c.action;
    game.appendChild(b);
  });
}

/* ---------- 오프닝 ---------- */
function start(){
render(
`여느 날과 같은 새벽이다.

대인 기피증 때문에
사람이 없는 한적한 새벽에
강아지 산책을 나와 있었다.

퍽—

그 이후의 기억이 없다.

눈을 뜨자 낯선 방이다.
창문은 모두 신문지와 나무 판자로 막혀 있다.`,
[
 {text:"나간다", action: doorLocked},
 {text:"방을 살핀다", action: inspectRoom},
 {text:"대기한다", action: waitDeath}
]);
}

/* ---------- 방 ---------- */
function doorLocked(){
render(
`문을 열려 했지만 잠겨 있다.
열쇠가 필요해 보인다.`,
[
 {text:"침대 밑", action: bed},
 {text:"서랍", action: drawer},
 {text:"옷장", action: closet}
]);
}

function bed(){
render(
`침대 밑에는 사람이 있다.
…움직이지 않는다.
시체인 것 같다.`,
[
 {text:"뒤로", action: doorLocked}
]);
}

function drawer(){
if(!state.tweezers){
 state.tweezers=true;
 render(
`서랍 안에서 핀셋을 발견했다.

이거라면 문을 열 수 있을지도 모르겠다.`,
[
 {text:"뒤로", action: doorLocked}
]);
}else{
 render(
`서랍 안에는 아무것도 없다.`,
[
 {text:"뒤로", action: doorLocked}
]);
}
}

function closet(){
render(
`옷장 안에는 별다른 것은 없다.
숨기에는 좋아 보인다.`,
[
 {text:"뒤로", action: doorLocked}
]);
}

function inspectRoom(){
render(
`바닥에서 문서를 발견했다.

이름: 판태현
나이: 30
직업: 무직
주소: 서울특별시 성동구…

간 양호
신장 양호
각막 양호…

내 장기에 관한 정보다.

…장기 매매.`,
[
 {text:"뒤로", action: doorLocked}
]);
}

function waitDeath(){
render(
`10분쯤 지났을까.
복도에서 발소리가 들린다.`,
[
 {text:"가만히 있는다", action: death}
]);
}

/* ---------- 복도 ---------- */
function exitRoom(){
render(
`핀셋으로 문을 열었다.
집은 2층 구조인 듯하다.`,
[
 {text:"서재", action: study},
 {text:"계단으로 내려간다", action: kitchenIntro}
]);
}

/* ---------- 서재 ---------- */
function study(){
render(
`서재인 듯하다.
사진과 해부학 서적들이 가득하다.`,
[
 {text:"밖으로 나간다", action: noiseWait},
 {text:"책들을 뒤진다", action: secretNote},
 {text:"서랍을 뒤진다", action: basementKey}
]);
}

function noiseWait(){
render(
`복도에서 인기척이 느껴진다.
숨죽이며 기다려야겠다.`,
[
 {text:"계속 기다린다", action: kitchenIntro}
]);
}

function secretNote(){
render(
`책 하나를 잡아당기자
비밀 공간이 열린다.

“이 글을 읽고 있다면
당신도 잡혀왔겠죠…”

탈출구는
현관 / 지하실

현관: 비밀번호 + 열쇠
지하실: 도끼 열쇠

행운을 빕니다.`,
[
 {text:"뒤로", action: study}
]);
}

function basementKey(){
if(!state.basementKey){
 state.basementKey=true;
 render(
`서랍에서 열쇠를 발견했다.
(지하실 열쇠)`,
[
 {text:"뒤로", action: study}
]);
}else{
 render(
`이미 열쇠를 챙겼다.`,
[
 {text:"뒤로", action: study}
]);
}
}

/* ---------- 주방 ---------- */
function kitchenIntro(){
render(
`주방이다.
냉장고, 싱크대, 식탁이 보인다.

…인기척이 느껴진다.`,
[
 {text:"싱크대 아래", action: caughtDeath},
 {text:"식탁 아래", action: laugh},
 {text:"도망친다", action: bathroom}
]);
}

/* ---------- 화장실 ---------- */
function bathroom(){
render(
`화장실로 도망쳤다.
발소리가 점점 가까워진다.`,
[
 {text:"문 뒤", action: escapeSuccess},
 {text:"변기 뒤", action: basementCaptured},
 {text:"욕조", action: bathtub}
]);
}

/* ---------- 거실 ---------- */
function livingRoom(){
render(
`거실이다.
서랍, 옷장, TV가 있다.`,
[
 {text:"서랍", action: safeKey},
 {text:"옷장", action: hide},
 {text:"TV", action: tvHint},
 {text:"지하실", action: basementCheck},
 {text:"현관", action: lobbyCheck}
]);
}

/* ---------- 엔딩 ---------- */
function lobbyCheck(){
if(state.lobbyKey && state.passwordKnown){
render(
`비밀번호를 입력했다.
문이 열린다.

…2층에서 문이 열리는 소리.

도망쳐야 한다.`,
[
 {text:"달린다", action: escapeGood}
]);
}else{
render(
`아직 나갈 수 없다.`,
[
 {text:"뒤로", action: livingRoom}
]);
}
}

function escapeGood(){
render(
`어느 숲속에서 공중전화 박스를 발견했다.`,
[
 {text:"신고한다", action: badEnding},
 {text:"그냥 간다", action: goodEnding}
]);
}

/* ---------- 공통 ---------- */
function death(){
render(`“깨어있네?”\n\n사망…`);
}

function badEnding(){
render(`경찰은 가짜였다.\n\n사망…`);
}

function goodEnding(){
render(
`나는 탈출했다.

하지만
그 일 이후로
나는 더 깊은 대인기피증을 얻었다.

…망할 블로그.`,
[]);
}

function caughtDeath(){ death(); }
function laugh(){ death(); }
function bathtub(){ death(); }
function basementCaptured(){ death(); }
function escapeSuccess(){ livingRoom(); }
function safeKey(){ state.lobbyKey=true; livingRoom(); }
function hide(){ livingRoom(); }
function tvHint(){ state.passwordKnown=true; livingRoom(); }
function basementCheck(){ death(); }

start();
</script>

</body>
</html>
