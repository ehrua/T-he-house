<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>탈출</title>
<style>
body {
  background:#000;
  color:#eee;
  font-family:Malgun Gothic, sans-serif;
}
#game { max-width:600px; margin:auto; }
button {
  display:block;
  margin:6px 0;
  padding:8px;
  background:#111;
  color:#eee;
  border:1px solid #555;
}
button:hover { background:#333; }
#backBtn { opacity:0.7; }
</style>
</head>
<body>

<div id="game">
  <button id="backBtn">← 뒤로 가기</button>
  <div id="text"></div>
  <div id="choices"></div>
</div>

<script>
const text = document.getElementById("text");
const choices = document.getElementById("choices");
const backBtn = document.getElementById("backBtn");

let history = [];
let canGoBack = true;

let inventory = {
  pinset:false
};

function clearUI() {
  choices.innerHTML = "";
}

function addChoice(label, action) {
  const btn = document.createElement("button");
  btn.textContent = label;
  btn.onclick = action;
  choices.appendChild(btn);
}

backBtn.onclick = () => {
  if (!canGoBack || history.length <= 1) return;
  history.pop();
  history[history.length - 1]();
};

function go(scene, backable = true) {
  canGoBack = backable;
  backBtn.style.display = backable ? "block" : "none";
  history.push(scene);
  clearUI();
  scene();
}

/* ───── SCENES ───── */

function intro() {
  text.innerHTML = `
여느 날과 같은 새벽이다.<br>
대인 기피증 때문에 사람이 없는 새벽에 강아지 산책을 나왔다.<br>
퍽 소리와 함께 기억을 잃었다.
`;
  addChoice("다음", () => go(wakeUp));
}

function wakeUp() {
  text.innerHTML = `
눈을 떠보니 어느 집이다.<br>
창문은 모두 신문지와 나무 판자로 막혀 있다.
`;
  addChoice("나간다", () => go(lockedDoor));
  addChoice("방을 살핀다", () => go(room));
  addChoice("대기한다", () => go(waiting, false));
}

function room() {
  text.innerHTML = "방 안에는 침대, 서랍, 옷장이 있다.";
  addChoice("침대 밑", () => {
    text.innerHTML = "사람 같은 것이 있다… 시체인 듯하다.";
  });
  addChoice("서랍", () => go(drawer));
  addChoice("옷장", () => {
    text.innerHTML = "옷장은 비어 있다. 숨기엔 좋아 보인다.";
  });
}

function drawer() {
  inventory.pinset = true;
  text.innerHTML = `
서랍에서 핀셋을 발견했다.<br>
이걸로 문을 열 수 있을 것 같다.
`;
  addChoice("문으로 간다", () => go(unlockDoor));
}

function lockedDoor() {
  text.innerHTML = "문은 잠겨 있다.";
  if (inventory.pinset) {
    addChoice("핀셋을 사용한다", () => go(unlockDoor));
  }
}

function unlockDoor() {
  text.innerHTML = "철컥… 문이 열렸다.";
  addChoice("계단으로 간다", () => {
    text.innerHTML = "다음 구간 진행 가능";
  });
}

function waiting() {
  text.innerHTML = `
10분쯤 지났을까.<br>
발소리가 점점 가까워진다…
`;
  addChoice("가만히 있는다", () => {
    text.innerHTML = "“깨어있네?”<br><b>사망</b>";
  });
}

/* START */
go(intro);
</script>
</body>
</html>
